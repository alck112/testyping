- name: Build CandidateUI (diag + binlog)
  shell: pwsh
  run: |
    dotnet --info
    dotnet build CandidateUI/ScjWin11UI.csproj -c Release -v diag -bl:winui.binlog

- name: Dump XAML compiler outputs if present
  if: failure()
  shell: pwsh
  run: |
    $p = "CandidateUI\obj\Release\net8.0-windows10.0.19041.0"
    Write-Host "Listing $p"
    if (Test-Path $p) { Get-ChildItem $p -Recurse | Select-Object FullName | Out-Host } else { Write-Host "No obj folder found" }
    $out = Join-Path $p "output.json"
    if (Test-Path $out) {
      Write-Host "==== output.json (last 200 lines) ===="
      Get-Content $out -Tail 200 | Out-Host
    } else {
      Write-Host "output.json not found"
    }

- name: Upload binlog
  if: always()
  uses: actions/upload-artifact@v4
  with:
    name: winui-build-logs
    path: |
      winui.binlog
      CandidateUI/obj/**/output.json
      CandidateUI/obj/**/input.json
